linux进程查看连载之linux top命令2009-10-27 16:34 linux 我要评论(1) 字号：T | T
本文主要讲解了linux top命令的概念以及其使用方法，还有它的好多参数的使用，例如d 指定每两次屏幕信息刷新之间的时间间隔。S 指定累计模式c 显示整个命令行而不只是显示命令名等解释。

AD： 


linux进程查看中有很多值得我们学习的地方，这里我们主要介绍linux top命令，包括介绍top命令的参数等方面。
top命令和ps命令的基本作用是相同的，显示系统当前的进程和其他状况；但是top是一个动态显示过程，即可以通过用户按键来不断刷新当前状态。如果在前台执行该命令，它将独占前台，直到用户终止该程序为止。比较准确的说，top命令提供了实时的对系统处理器的状态监视。它将显示系统中CPU最“敏感”的任务列表。该命令可以按CPU使用。内存使用和执行时间对任务进行排序；而且该命令的很多特性都可以通过交互式命令或者在个人定制文件中进行设定。在后面的介绍中将把命令参数和交互命令分开讲述。

下面是该命令的语法格式：
◆top [-] [d delay] [q] [c] [s] [S]
◆d 指定每两次屏幕信息刷新之间的时间间隔。当然用户可以使用s交互命令来改变之。
◆q 该选项将使top没有任何延迟的进行刷新。如果调用程序有超级用户权限，那么top将以尽可能高的优先级运行。
◆S 指定累计模式。
◆s 使top命令在安全模式中运行。这将去除交互命令所带来的潜在危险。
◆i 使top不显示任何闲置或者僵死进程。
◆c 显示整个命令行而不只是显示命令名
◆top命令显示的项目很多，默认值是每5秒更新一次，当然这是可以设置的。

显示的各项目为： uptime 该项显示的是系统启动时间、已经运行的时间和三个平均负载值（最近1秒，5秒，15秒的负载值）。 processes 自最近一次刷新以来的运行进程总数。当然这些进程被分为正在运行的，休眠的，停止的等很多种类。进程和状态显示可以通过交互命令t来实现。

◆CPU states 显示用户模式，系统模式，优先级进程（只有优先级为负的列入考虑）和闲置等各种情况所占用CPU时间的百分比。优先级进程所消耗的时间也被列入到用户和系统的时间中，所以总的百分比将大于100%。
◆Mem 内存使用情况统计，其中包括总的可用内存，空闲内存，已用内存，共享内存和缓存所占内存的情况。
◆Swap 交换空间统计，其中包括总的交换空间，可用交换空间，已用交换空间。
◆PID 每个进程的ID。
◆PPID 每个进程的父进程ID。
◆UID 每个进程所有者的UID 。
◆USER 每个进程所有者的用户名。
◆PRI 每个进程的优先级别。
◆NI 该进程的优先级值。
◆SIZE 该进程的代码大小加上数据大小再加上堆栈空间大小的总数。单位是KB。
◆TSIZE 该进程的代码大小。对于内核进程这是一个很奇怪的值。
◆DSIZE 数据和堆栈的大小。
◆TRS 文本驻留大小。
◆D 被标记为“不干净”的页项目。
◆LIB 使用的库页的大小。对于ELF进程没有作用。
◆RSS 该进程占用的物理内存的总数量，单位是KB。
◆SHARE 该进程使用共享内存的数量。
◆STAT 该进程的状态。
◆其中S代表休眠状态；
◆D代表不可中断的休眠状态；
◆R代表运行状态；
◆Z代表僵死状态；
◆T代表停止或跟踪状态。
◆TIME 该进程自启动以来所占用的总CPU时间。如果进入的是累计模式，那么该时间还包括这个进程子进程所占用的时间。且标题会变成CTIME。
◆%CPU 该进程自最近一次刷新以来所占用的CPU时间和总时间的百分比。
◆%MEM 该进程占用的物理内存占总内存的百分比。
◆COMMAND 该进程的命令名称，如果一行显示不下，则会进行截取。内存中的进程会有一个完整的命令行。

下面介绍在linux top命令执行过程中可以使用的一些交互命令。从使用角度来看，熟练的掌握这些命令比掌握选项还重要一些。这些命令都是单字母的，如果在命令行选项中使用了s选项，则可能其中一些命令会被屏蔽掉。
◆<空格> 立即刷新显示。
◆Ctrl+L 擦除并且重写屏幕。
◆h或者? 显示帮助画面，给出一些简短的命令总结说明。
◆k 终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用15信号；如果不能正常结束那就使用信号9强制结束该进程。默认值是信号15。在安全模式中此命令被屏蔽。
◆i 忽略闲置和僵死进程。这是一个开关式命令。
◆q 退出程序。
◆r 重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是10。
◆S 切换到累计模式。
◆s 改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为s。如果有小数，就换算成m s。输入0值则系统将不断刷新，默认值是5 s。需要注意的是如果设置太小的时间，很可能会引起不断刷新，从而根本来不及看清显示的情况，而且系统负载也会大大增加。
◆f或者F 从当前显示中添加或者删除项目。
◆o或者O 改变显示项目的顺序。
◆l 切换显示平均负载和启动时间信息。
◆m 切换显示内存信息。
◆t 切换显示进程和CPU状态信息。
◆c 切换显示命令名称和完整命令行。
◆M 根据驻留内存大小进行排序。
◆P 根据CPU使用百分比大小进行排序。
◆T 根据时间/累计时间进行排序。
◆W 将当前设置写入~/.toprc文件中。这是写top配置文件的推荐方法。

从上面的介绍中可以看到，linux top命令是一个功能十分强大的监控系统的工具，尤其对于系统管理员而言更是如此。一般的用户可能会觉得ps命令其实就够用了，但是top命令的强劲功能确实提供了不少方便。下面来看看实际使用的情况。
top命令查看系统状况
$ top
1：55pm up 7 min， 4 user， load average:0.07，0.09，0.06
29 processes:28 sleeping， 1 running， 0 zombie， 0 stopped
CPU states: 4.5% user， 3.6% system， 0.0% nice， 91.9% idle
Mem: 38916K av， 18564K used， 20352K free， 11660K shrd， 1220K buff
Swap: 33228K av， 0K used， 33228K free， 11820K cached
PID USER PRI NI SIZE RSS SHARE STAT LIB %CPU %MEM TIME COMMAND
363 root 14 0 708 708 552 R 0 8.1 1.8 0:00 top
1 root 0 0 404 404 344 S 0 0.0 1.0 0:03 init
2 root 0 0 0 0 0 SW 0 0.0 0.0 0:00 kflushd
3 root -12 -12 0 0 0 SW< 0 0.0 0.0 0:00 kswapd
4 root 0 0 0 0 0 SW 0 0.0 0.0 0:00 md_thread
5 root 0 0 0 0 0 SW 0 0.0 0.0 0:00 md_thread
312 root 1 0 636 636 488 S 0 0.0 1.6 0:00 telnet
285 root 6 0 1140 1140 804 S 0 0.0 2.9 0.00 bash
286 root 0 0 1048 1048 792 S 0 0.0 2.6 0.00 bash
25 root 0 0 364 364 312 S 0 0.0 0.9 0.00 kerneld
153 root 0 0 456 456 372 S 0 0.0 1.1 0.00 syslogd
160 root 0 0 552 552 344 S 0 0.0 1.4 0.00 klogd
169 daemon 0 0 416 416 340 S 0 0.0 1.0 0.00 atd
178 root 2 0 496 496 412 S 0 0.0 1.2 0.00 crond
187 bin 0 0 352 352 284 S 0 0.0 0.9 0.00 portmap
232 root 0 0 500 500 412 S 0 0.0 1.2 0.00 rpc.mountd
206 root 0 0 412 412 344 S 0 0.0 1.0 0.00 inetd
215 root 0 0 436 436 360 S 0 0.0 1.1 0.00 icmplog
第一行的项目依次为当前时间、系统启动时间、当前系统登录用户数目、平均负载。第二行为进程情况，依次为进程总数、休眠进程数、运行进程数、僵死进程数、终止进程数。第三行为CPU状态，依次为用户占用、系统占用、优先进程占用、闲置进程占用。第四行为内存状态，依次为平均可用内存、已用内存、空闲内存、共享内存、缓存使用内存。第五行为交换状态，依次为平均可用交换容量、已用容量、闲置容量、高速缓存容量。然后下面就是和ps相仿的各进程情况列表了。

